<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-800 text-gray-100 min-h-screen p-4 md:p-8">

    <div class="container mx-auto max-w-7xl">
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
            <h1 class="text-3xl font-bold">üõ†Ô∏è Admin</h1>
            <div class="flex items-center gap-4 text-sm">
                <span class="text-gray-400 hidden md:inline">User: {{ user }}</span>
                <a href="/logout" class="text-red-400">Odhl√°sit</a>
                <a href="/" class="bg-blue-600 px-4 py-2 rounded text-white">Na E-shop</a>
            </div>
        </div>

        <div class="bg-gray-700 p-4 md:p-6 rounded-lg shadow-xl mb-8 border border-gray-600">
            <h2 class="text-xl font-bold mb-4 text-purple-400"><i class="fas fa-tags mr-2"></i> Spr√°va kategori√≠</h2>
            
            <div class="flex flex-col md:flex-row gap-6">
                <form action="/admin/add_category" method="POST" class="flex gap-2 w-full md:w-1/3">
                    <input type="text" name="name" placeholder="Nov√° kategorie..." required class="flex-grow bg-gray-800 border border-gray-600 p-2 rounded text-white">
                    <button type="submit" class="bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded font-bold text-white"><i class="fas fa-plus"></i></button>
                </form>

                <div class="flex flex-wrap gap-2 w-full md:w-2/3">
                    {% for cat in categories %}
                    <span class="bg-gray-800 border border-gray-600 px-3 py-1 rounded-full text-sm flex items-center gap-2">
                        {{ cat.name }}
                        <a href="/admin/delete_category/{{ cat.id }}" onclick="return confirm('Smazat kategorii {{ cat.name }}?')" class="text-red-400 hover:text-red-300 ml-1">
                            <i class="fas fa-times"></i>
                        </a>
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
            
            <div class="bg-gray-700 p-4 md:p-6 rounded-lg shadow-xl">
                <h2 class="text-xl font-bold mb-4 text-blue-400">Objedn√°vky</h2>
                <div class="space-y-4 max-h-[700px] overflow-y-auto pr-2">
                    {% for order in orders %}
                    <div class="bg-gray-600 p-4 rounded border-l-4 border-gray-500">
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-bold">#{{ order.id }}</span> 
                            <span class="bg-gray-800 px-2 py-1 rounded text-xs">{{ order.status }}</span>
                        </div>
                        <p class="font-bold">{{ order.customer_name }}</p>
                        <p class="text-sm text-gray-300">{{ order.email }}</p>
                        <p class="text-right font-bold text-green-400 text-lg mt-2">{{ order.total_price }} Kƒç</p>

                        <form action="/admin/update_status/{{ order.id }}" method="POST" class="mt-2 flex gap-2">
                            <select name="new_status" class="bg-gray-800 text-white p-2 rounded border border-gray-500 text-sm flex-grow">
                                <option value="Nov√°" {% if order.status == 'Nov√°' %}selected{% endif %}>Nov√°</option>
                                <option value="Odesl√°na" {% if order.status == 'Odesl√°na' %}selected{% endif %}>Odesl√°na</option>
                                <option value="Zpracov√°v√° se" {% if order.status == 'Zpracov√°v√° se' %}selected{% endif %}>Zpracov√°v√° se</option>
                            </select>
                            <button type="submit" class="bg-blue-600 px-3 py-1 rounded text-sm text-white">OK</button>
                        </form>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="space-y-8">
                <div class="bg-gray-700 p-4 md:p-6 rounded-lg shadow-xl">
                    <h2 class="text-xl font-bold mb-4 text-green-400">Nov√Ω Produkt</h2>
                    <form action="/admin/add_product" method="POST" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="md:col-span-2"><label class="block text-xs text-gray-400">N√°zev</label><input type="text" name="name" required class="w-full bg-gray-800 border border-gray-600 p-2 rounded text-white"></div>
                        
                        <div><label class="block text-xs text-gray-400">Cena</label><input type="number" name="price" required class="w-full bg-gray-800 border border-gray-600 p-2 rounded text-white"></div>
                        <div><label class="block text-xs text-gray-400">P≈Øv. cena</label><input type="number" name="original_price" value="0" class="w-full bg-gray-800 border border-gray-600 p-2 rounded text-white"></div>

                        <div class="md:col-span-2">
                            <label class="block text-xs text-gray-400">Kategorie</label>
                            <select name="category" class="w-full bg-gray-800 border border-gray-600 p-2 rounded text-white">
                                {% for cat in categories %}
                                <option value="{{ cat.name }}">{{ cat.name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="md:col-span-2"><label class="block text-xs text-gray-400">Popis</label><textarea name="description" rows="2" required class="w-full bg-gray-800 border border-gray-600 p-2 rounded text-white"></textarea></div>
                        <div class="md:col-span-2"><label class="block text-xs text-gray-400">Obr√°zek</label><input type="file" name="image" required class="w-full bg-gray-800 text-sm"></div>
                        <div class="md:col-span-2"><label class="block text-xs text-blue-400">Galerie</label><input type="file" name="gallery_images" multiple class="w-full bg-gray-800 text-sm"></div>

                        <button type="submit" class="md:col-span-2 bg-green-600 py-3 rounded font-bold mt-2">Nahr√°t</button>
                    </form>
                </div>

                <div class="bg-gray-700 p-4 md:p-6 rounded-lg shadow-xl">
                    <h2 class="text-xl font-bold mb-4 text-yellow-400">Seznam</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm text-gray-300">
                            {% for p in products %}
                            <tr class="border-b border-gray-600">
                                <td class="p-2"><img src="{{ p.img }}" class="w-8 h-8 rounded"></td>
                                <td class="p-2 font-bold">{{ p.name }}</td>
                                <td class="p-2">{{ p.price }} Kƒç</td>
                                <td class="p-2 text-right">
                                    <a href="/admin/edit_product/{{ p.id }}" class="text-blue-400"><i class="fas fa-pen"></i></a>
                                    <a href="/admin/delete_product/{{ p.id }}" onclick="return confirm('Smazat?')" class="text-red-400 ml-2"><i class="fas fa-trash"></i></a>
                                </td>
                            </tr>
                            {% endfor %}
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>